<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Developer Page</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header>
        <nav>
            <a href="/index.html">Home</a>
            <a href="/register.html">Register</a>
            <a href="/login.html">Login</a>
        </nav>
    </header>

    <main>
        <div class="readme">
            <h1>UserRegistrationServer</h1>

            <p>UserRegistrationServer е web client-server application, създадено без използването на каквито и да е frameworks и външни services.</p>

            <h2>Технологии</h2>
            <ul>
                <li>C# за сървърната логика и писането на тестове</li>
                <li>HTML, CSS, JS за клиентската част. JavaScript се използва за изпращане на request-и към сървърната част с JSON данни и за генериране на captcha</li>
            </ul>

            <h2>Структура на кода</h2>
            <p>Приложението е разделено на 2 проекта:</p>
            <ul>
                <li><b>UserRegistrationServer</b> – wwwroot, data, services, repositories, тук се намира кодът на приложението</li>
                <li><b>UserRegistrationTests</b> – тук се намират NUnit тестовете</li>
            </ul>
            <p>Приложението използва standard repository design pattern и многослойна архитектура. Макар да не се използват ASP.NET функционалности, системата е гъвкава и лесна за разширение.</p>

            <h2>Реализация</h2>
            <p>В <b>Program.cs</b> се стартира кодът. Определяме порт, инициализираме services и controllers. След това безкраен цикъл слуша за заявки. <b>ServeStaticFileAsync</b> връща конкретни страници с CSS и JS.</p>

            <h3>/controllers</h3>
            <ul>
                <li><b>UserController</b> – използва <b>UserService</b> чрез Dependency Injection. Получава <code>HttpListenerContext</code>, обработва JSON заявки и връща резултати като <b>RegisterResult</b> и <b>LoginResult</b>.</li>
            </ul>

            <h3>/data</h3>
            <ul>
                <li><b>Context</b> – подсигурява база данни. <b>EnsureDatabaseExists</b> и <b>EnsureTablesExist</b> създават база и таблици при необходимост.</li>
                <li><b>LoginResult, RegisterResult</b> – обекти за резултатите от login/registration.</li>
                <li><b>User</b> – модел, който се връща на клиентската част.</li>
            </ul>

            <h3>/repositories</h3>
            <ul>
                <li><b>IUserRepository</b> и <b>UserRepository</b> – асинхронни операции за достъп до MySQL база. Използват параметризирани заявки за защита от SQL injection.</li>
            </ul>

            <h3>/services</h3>
            <ul>
                <li><b>PasswordManager</b> – хеширане на пароли с PBKDF2 и сол, валидация на пароли.</li>
                <li><b>UserService</b> – бизнес логика и валидация, връзка между база данни и контролер.</li>
            </ul>

            <h3>/wwwroot</h3>
            <ul>
                <li>HTML, CSS, JS файлове. JS файловете се добавят в head или body в зависимост от нуждата да се заредят преди или след DOM.</li>
                <li><b>/scripts</b> – всички *.js файлове за изпращане на данни, captcha и динамични UI елементи.</li>
            </ul>

            <h3>/UserRegistrationTests</h3>
            <ul>
                <li>МСBuild тестове</li>
                <li>Integrated тестове за <b>UserRepository</b> с тестова MySQL база</li>
                <li>Moq и NUnit тестове за <b>UserService</b></li>
            </ul>
        </div>
    </main>

    <footer>
        <p>Contact me: <a href="mailto:teodichev@gmail.com">teodichev@gmail.com</a></p>
        <p>
            <a href="https://github.com/TeodorDichev" target="_blank">GitHub</a> |
            <a href="https://linkedin.com/in/TeodorDichev" target="_blank">LinkedIn</a> |
            <a href="/index.html">Home</a>
        </p>
    </footer>

</body>
</html>
